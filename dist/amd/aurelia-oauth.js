define(["require", "exports", 'aurelia-router', 'aurelia-http-client', './oauth-service', './oauth-token-service', './oauth-interceptor', './oauth-authorize-step'], function (require, exports, aurelia_router_1, aurelia_http_client_1, oauth_service_1, oauth_token_service_1, oauth_interceptor_1, oauth_authorize_step_1) {
    "use strict";
    exports.OAuthService = oauth_service_1.OAuthService;
    function configure(framework, config) {
        var oauthService = framework.container.get(oauth_service_1.OAuthService);
        var oauthTokenService = framework.container.get(oauth_token_service_1.OAuthTokenService);
        var httpClient = framework.container.get(aurelia_http_client_1.HttpClient);
        var oauthInterceptor = framework.container.get(oauth_interceptor_1.default);
        config(oauthService, oauthTokenService);
        httpClient.configure(function (builder) { return builder.withInterceptor(oauthInterceptor); });
        framework.aurelia.start().then(function () {
            oauthService.setTokenOnRedirect();
            var appRouter = framework.container.get(aurelia_router_1.AppRouter);
            appRouter.pipelineProvider.steps.splice(2, 0, oauth_authorize_step_1.OAuthAuthorizeStep);
        });
    }
    exports.configure = configure;
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1cmVsaWEtb2F1dGgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7SUE4QkUsb0JBQVk7SUFyQmQsbUJBQTBCLFNBQWlDLEVBQUUsTUFBaUQ7UUFFMUcsSUFBSSxZQUFZLEdBQWlCLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLDRCQUFZLENBQUMsQ0FBQztRQUN2RSxJQUFJLGlCQUFpQixHQUFzQixTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyx1Q0FBaUIsQ0FBQyxDQUFDO1FBQ3RGLElBQUksVUFBVSxHQUFlLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGdDQUFVLENBQUMsQ0FBQztRQUNqRSxJQUFJLGdCQUFnQixHQUFxQixTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQywyQkFBZ0IsQ0FBQyxDQUFDO1FBRW5GLE1BQU0sQ0FBQyxZQUFZLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztRQUV4QyxVQUFVLENBQUMsU0FBUyxDQUFDLFVBQUEsT0FBTyxJQUFJLE9BQUEsT0FBTyxDQUFDLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUF6QyxDQUF5QyxDQUFDLENBQUM7UUFFM0UsU0FBUyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDN0IsWUFBWSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFHbEMsSUFBSSxTQUFTLEdBQWMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsMEJBQVMsQ0FBQyxDQUFDO1lBQ3hELFNBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUseUNBQWtCLENBQUMsQ0FBQztRQUMzRSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFsQmUsaUJBQVMsWUFrQnhCLENBQUE7SUFJQSIsImZpbGUiOiJhdXJlbGlhLW9hdXRoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRnJhbWV3b3JrQ29uZmlndXJhdGlvbiB9IGZyb20gJ2F1cmVsaWEtZnJhbWV3b3JrJztcclxuaW1wb3J0IHsgQXBwUm91dGVyLCBSb3V0ZXJDb25maWd1cmF0aW9uIH0gZnJvbSAnYXVyZWxpYS1yb3V0ZXInO1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnYXVyZWxpYS1odHRwLWNsaWVudCc7XHJcblxyXG5pbXBvcnQgeyBPQXV0aFNlcnZpY2UgfSBmcm9tICcuL29hdXRoLXNlcnZpY2UnO1xyXG5pbXBvcnQgeyBPQXV0aFRva2VuU2VydmljZSB9IGZyb20gJy4vb2F1dGgtdG9rZW4tc2VydmljZSc7XHJcbmltcG9ydCBPQXV0aEludGVyY2VwdG9yIGZyb20gJy4vb2F1dGgtaW50ZXJjZXB0b3InO1xyXG5pbXBvcnQgeyBPQXV0aEF1dGhvcml6ZVN0ZXAgfSBmcm9tICcuL29hdXRoLWF1dGhvcml6ZS1zdGVwJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb25maWd1cmUoZnJhbWV3b3JrOiBGcmFtZXdvcmtDb25maWd1cmF0aW9uLCBjb25maWc6IChvYXV0aFNlcnZpY2UsIG9hdXRoVG9rZW5TZXJ2aWNlKSA9PiB2b2lkKSB7XHJcblxyXG4gICAgdmFyIG9hdXRoU2VydmljZSA9IDxPQXV0aFNlcnZpY2U+ZnJhbWV3b3JrLmNvbnRhaW5lci5nZXQoT0F1dGhTZXJ2aWNlKTtcclxuICAgIHZhciBvYXV0aFRva2VuU2VydmljZSA9IDxPQXV0aFRva2VuU2VydmljZT5mcmFtZXdvcmsuY29udGFpbmVyLmdldChPQXV0aFRva2VuU2VydmljZSk7XHJcbiAgICB2YXIgaHR0cENsaWVudCA9IDxIdHRwQ2xpZW50PmZyYW1ld29yay5jb250YWluZXIuZ2V0KEh0dHBDbGllbnQpO1xyXG4gICAgdmFyIG9hdXRoSW50ZXJjZXB0b3IgPSA8T0F1dGhJbnRlcmNlcHRvcj5mcmFtZXdvcmsuY29udGFpbmVyLmdldChPQXV0aEludGVyY2VwdG9yKTtcclxuXHJcbiAgICBjb25maWcob2F1dGhTZXJ2aWNlLCBvYXV0aFRva2VuU2VydmljZSk7XHJcblxyXG4gICAgaHR0cENsaWVudC5jb25maWd1cmUoYnVpbGRlciA9PiBidWlsZGVyLndpdGhJbnRlcmNlcHRvcihvYXV0aEludGVyY2VwdG9yKSk7XHJcblxyXG4gICAgZnJhbWV3b3JrLmF1cmVsaWEuc3RhcnQoKS50aGVuKCgpID0+IHtcclxuICAgICAgb2F1dGhTZXJ2aWNlLnNldFRva2VuT25SZWRpcmVjdCgpO1xyXG5cclxuICAgICAgLy8gQWRkIGF1dGhvcml6ZSBzdGVwIGJlZm9yZSB2aWV3LW1vZGVsIGFjdGl2YXRlIHByZWRlZmluZWQgcGlwZWxpbmUgc3RlcFxyXG4gICAgICBsZXQgYXBwUm91dGVyID0gPEFwcFJvdXRlcj5mcmFtZXdvcmsuY29udGFpbmVyLmdldChBcHBSb3V0ZXIpO1xyXG4gICAgICAoPGFueT5hcHBSb3V0ZXIpLnBpcGVsaW5lUHJvdmlkZXIuc3RlcHMuc3BsaWNlKDIsIDAsIE9BdXRoQXV0aG9yaXplU3RlcCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBPQXV0aFNlcnZpY2VcclxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
